# –°–≤–æ–¥–∫–∞: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –°–±–µ—Ä–ò–Ω–¥–µ–∫—Å–∞ POAD

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î `sberindex`

**–°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (8 —à—Ç.):**
- `dict_regions` - 10 —Ä–µ–≥–∏–æ–Ω–æ–≤ –†–§
- `dict_municipalities` - 192 –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
- `dict_settlements` - 128 –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤
- `dict_data_blocks` - 10 –±–ª–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- `dict_rating_domains` - 9 –¥–æ–º–µ–Ω–æ–≤ —Ä–µ–π—Ç–∏–Ω–≥–∞
- `dict_data_sources` - 6 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- `dict_indicators` - 93 –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è
- `dict_esg_blocks` - 9 ESG –±–ª–æ–∫–æ–≤

**–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (3 —Ç–∞–±–ª–∏—Ü—ã):**
- `meta_settlement_attributes` - 128 –∑–∞–ø–∏—Å–µ–π (arctic, remote, special, suburb)
- `meta_settlement_coordinates` - 128 –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- `meta_settlement_population` - 128 –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π

**–§–∞–∫—Ç-—Ç–∞–±–ª–∏—Ü–∞ (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è):**
- `fact_settlement_indicators` - **8,159 –∑–∞–ø–∏—Å–µ–π** (–≤–º–µ—Å—Ç–æ 128 —Å—Ç—Ä–æ–∫ √ó 94 –∫–æ–ª–æ–Ω–∫–∏)

### 2. –ú–∏–≥—Ä–∞—Ü–∏–∏ SQL

–°–æ–∑–¥–∞–Ω—ã 3 –º–∏–≥—Ä–∞—Ü–∏–∏:
- [001_create_schema.sql](sql/001_create_schema.sql) - —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã
- [002_create_dictionaries.sql](sql/002_create_dictionaries.sql) - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
- [003_create_fact_tables.sql](sql/003_create_fact_tables.sql) - —Ñ–∞–∫—Ç-—Ç–∞–±–ª–∏—Ü—ã –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã

### 3. ETL —Å–∫—Ä–∏–ø—Ç—ã

- [apply_migrations.py](apply_migrations.py) - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- [etl_load_sberindex.py](etl_load_sberindex.py) - –ø–æ–ª–Ω—ã–π ETL –ø—Ä–æ—Ü–µ—Å—Å (670 —Å—Ç—Ä–æ–∫)

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [README_ETL.md](README_ETL.md) - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- SUMMARY.md - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

### –î–æ (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
```
128 —Å—Ç—Ä–æ–∫ √ó 94 –∫–æ–ª–æ–Ω–∫–∏ = 12,032 —è—á–µ–π–∫–∏ (—Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏)
```

### –ü–æ—Å–ª–µ (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
```
8,159 —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
+ 12 —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
+ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (3NF)** - –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–ê—É–¥–∏—Ç** - —Ç—Ä–∏–≥–≥–µ—Ä—ã updated_at, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π audit_log
5. **–ì–∏–±–∫–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ numeric/text/boolean –∑–Ω–∞—á–µ–Ω–∏–π

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **10 —Ä–µ–≥–∏–æ–Ω–æ–≤** –†–æ—Å—Å–∏–∏
- **192 –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞** (–≤–µ—Ä—Ö–Ω–∏–π/–Ω–∏–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å)
- **128 –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤**

### –ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –ù–ü –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
1. –ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å - 12 –ù–ü
2. –Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –ê–û - 11 –ù–ü
3. –ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å - 5 –ù–ü
4. –ß—É–∫–æ—Ç—Å–∫–∏–π –ê–û - 4 –ù–ü
5. –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞—Ä–µ–ª–∏—è - 3 –ù–ü

### –°—Ä–µ–¥–Ω—è—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è
- –ü–æ—Å–µ–ª–∫–∏: ~6,447 —á–µ–ª. (14 –ù–ü)
- –†–∞–±–æ—á–∏–µ –ø–æ—Å–µ–ª–∫–∏: ~5,533 —á–µ–ª. (8 –ù–ü)
- –ü–ì–¢: ~5,014 —á–µ–ª. (79 –ù–ü)
- –°–µ–ª–∞: ~4,546 —á–µ–ª. (27 –ù–ü)

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
1. –ò–ù–°–¢–†–£–ú–ï–ù–¢–ê–õ–¨–ù–´–ï - 17 –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
2. –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê - 14 –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
3. –ó–î–†–ê–í–û–û–•–†–ê–ù–ï–ù–ò–ï - 12 –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
4. –û–ë–†–ê–ó–û–í–ê–ù–ò–ï - 9 –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
5. –≠–ö–û–ù–û–ú–ò–ö–ê - 9 –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
cd sberbank_hackaton_11_2025

# 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
python apply_migrations.py

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
python etl_load_sberindex.py --excel-path Data_SberIndex_POAD.xlsx --env-path ../.env
```

### –ü—Ä–∏–º–µ—Ä—ã SQL –∑–∞–ø—Ä–æ—Å–æ–≤

```sql
-- –í—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è –Ω–∞—Å–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞
SELECT s.settlement_name, i.indicator_name, f.value_numeric
FROM sberindex.fact_settlement_indicators f
JOIN sberindex.dict_settlements s ON f.settlement_id = s.settlement_id
JOIN sberindex.dict_indicators i ON f.indicator_id = i.indicator_id
WHERE s.settlement_name LIKE '%–Ø–∫—É—Ç—Å–∫%';

-- –ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã–µ –ø—É–Ω–∫—Ç—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
SELECT s.settlement_name, c.latitude, c.longitude, p.population_total
FROM sberindex.dict_settlements s
JOIN sberindex.meta_settlement_attributes a ON s.settlement_id = a.settlement_id
JOIN sberindex.meta_settlement_coordinates c ON s.settlement_id = c.settlement_id
JOIN sberindex.meta_settlement_population p ON s.settlement_id = p.settlement_id
WHERE a.is_arctic = TRUE;
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
sberbank_hackaton_11_2025/
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îú‚îÄ‚îÄ 001_create_schema.sql          # –°—Ö–µ–º–∞ sberindex
‚îÇ   ‚îú‚îÄ‚îÄ 002_create_dictionaries.sql    # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ 003_create_fact_tables.sql     # –§–∞–∫—Ç-—Ç–∞–±–ª–∏—Ü—ã
‚îú‚îÄ‚îÄ Data_SberIndex_POAD.xlsx           # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ apply_migrations.py                # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ etl_load_sberindex.py             # ETL –ø—Ä–æ—Ü–µ—Å—Å
‚îú‚îÄ‚îÄ README_ETL.md                      # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ SUMMARY.md                         # –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
```

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **PostgreSQL 16** - –°–£–ë–î
- **Python 3.11** - ETL —Å–∫—Ä–∏–ø—Ç—ã
- **pandas + openpyxl** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ Excel
- **psycopg2** - PostgreSQL –¥—Ä–∞–π–≤–µ—Ä
- **db_tools** - connection pooling

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤: ~0.5 —Å–µ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ –≥–µ–æ–≥—Ä–∞—Ñ–∏–∏: ~0.2 —Å–µ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö: ~0.3 —Å–µ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ 8,159 —Ñ–∞–∫—Ç–æ–≤: ~6 —Å–µ–∫ (–ø–∞–∫–µ—Ç–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è ETL: ~7 —Å–µ–∫—É–Ω–¥**

## üéì –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

1. **–û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ö–µ–º–∞** `sberindex` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ID** —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **–ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** (batch insert) —Ñ–∞–∫—Ç–æ–≤
4. **–¢—Ä–∏–≥–≥–µ—Ä—ã** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `updated_at`
5. **–ò–Ω–¥–µ–∫—Å—ã** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
6. **Connection pooling** –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
7. **Retry logic** –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- [ ] –°–æ–∑–¥–∞—Ç—å SQL views –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å dbt –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
- [ ] REST API endpoints –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- [ ] Dashboards –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-24
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
