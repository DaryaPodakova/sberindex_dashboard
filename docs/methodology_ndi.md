 

## Вступление
Привет! Меня зовут Дарья и я рада представить вам дашборд "ARCTIC INDEX-Индекс развития арктических населённых пунктов" по теме "Арктические переселения".
 
На сегодняшний день существует 128 малых населённых пунктов Арктической зоны Российской Федерации и меня восхищает стойкость людей, живущих там в непростых климатических условиях. 
И чтобы иметь возможность быстро оценить жизнь в подобных условиях , я решила создать композитный индекс оценки привлекательность арктических населённых пунктов:Northern Development Index (NDI).


## NDI
NDI = 0.35×POAD + 0.20×Market + 0.15×Consumption + 0.15×Access + 0.10×Climate + 0.05×Mobility

1. POAD.Качество жизни (35%) — медицина, образование, культура
2. Market.Доступность рынков (20%) — экономическая интеграция
3. Consumption.Покупательная способность (15%) — потребление vs прожиточный минимум
4. Access.Транспортная доступность (15%) — близость к хабам
5. Climate.Климат (10%) — затраты на отопление
6. Mobility.Мобильность населения (5%) — экономическая активность 

Каждый НП получает оценку 0-10. Чем выше балл, тем устойчивее территория."

### Откуда формируются показатели: Pipeline обработки данных

#### 1. POAD (Качество жизни) — 35% веса в NDI

**Расшифровка:**
- **P**opulation (Население)
- **O**pportunity (Возможности)
- **A**ttractiveness (Привлекательность)
- **D**evelopment (Развитие)

**Первичные данные:**
- **Файл:** `Data_SberIndex_POAD.xlsx` (187 КБ)
- **Источник:** SberIndex — данные организаторов хакатона
- **Структура:** 128 населённых пунктов × 93 показателя качества жизни
- **Домены:** Доходы, ЖКХ, Здравоохранение, Инфраструктура, Образование, Экология, Экономика, КМНС, Качество жизни

**Скрипты обработки:**

1. **`scripts/01_load_data.py`** — Загрузка Excel в PostgreSQL
   - Читает `Data_SberIndex_POAD.xlsx`
   - Создаёт таблицы: `dict_settlements`, `fact_settlement_indicators`, `dict_indicators`
   - Формирует pivot таблицу: НП × Показатели
   - **Выход:** `settlements_with_indicators.csv` (128 НП × 93 показателя)

2. **`scripts/02_correlation_analysis.py`** — Корреляционный анализ + PCA
   - Рассчитывает корреляцию каждого из 93 показателей с численностью населения
   - Выполняет PCA декомпозицию для снижения размерности
   - Отбирает **топ-10 факторов** с наивысшей корреляцией
   - **Выход:** `top_10_factors.csv`, `correlation_matrix.csv`, `pca_components.csv`

3. **`scripts/03_attractiveness_v1.py`** — Расчёт индекса привлекательности
   - Метод: **взвешенная сумма** топ-10 показателей (равные веса: 1/10 каждому)
   - Нормализация: MinMaxScaler (0-1 шкала)
   - Масштабирование: умножение на 10 → диапазон 0-10
   - **Выход:** `poad_attractiveness_v1.csv`

**Топ-10 показателей в POAD (по корреляции с населением):**

| Ранг | Код | Показатель | Корреляция | Домен |
|------|-----|-----------|------------|-------|
| 1 | 4.8 | Дома культуры и центры технического творчества (на 1000 чел) | 0.455 | ИНФРАСТРУКТУРА |
| 2 | 4.6 | Библиотеки (на 1000 чел) | 0.448 | ИНФРАСТРУКТУРА |
| 3 | 6.1 | Затраты на охрану окружающей среды | 0.414 | ЭКОЛОГИЯ |
| 4 | 4.12 | Доля доступного транспорта для маломобильных групп | 0.366 | ИНФРАСТРУКТУРА |
| 5 | 3.11 | Смертность в трудоспособном возрасте (на 100к) | 0.332 | ЗДРАВ |
| 6 | 7.4 | Уровень безработицы (на 1000 чел) | 0.323 | ЭКОНОМИКА |
| 7 | 7.2 | Наличие федеральных торговых сетей | 0.293 | ЭКОНОМИКА |
| 8 | 3.12 | Естественный прирост населения | 0.285 | ЗДРАВ |
| 9 | 5.3 | Средний балл ОГЭ по русскому языку | 0.265 | ОБРАЗОВАНИЕ |
| 10 | 6.5 | Выбросы загрязняющих веществ 2 класса опасности | 0.255 | ЭКОЛОГИЯ |

**Итоговый файл:**
- **Репозиторий:** `data/components/poad_attractiveness_v1.csv`
- **Размер:** 128 строк × 4 колонки
- **Колонки:** `settlement_id`, `settlement_name`, `attractiveness_v1` (0-10), `poad_normalized` (0-1)
- **Использование в NDI:** Нормализованное значение `poad_normalized` с весом 0.35

**Почему 35% веса?** Включает медицину, образование, культуру, экологию — ключевые факторы удержания населения в Арктике.

---

#### 2. Market Access (Доступность рынков) — 20% веса в NDI

**Первичные данные:**
- **Таблица БД:** `sberindex.market_access_municipality` (PostgreSQL)
- **Источник:** SberIndex — экономические данные Сбербанка
- **Период:** 2024 год

**Формула индекса:**
```
market_access = Σ (население_соседних_МО / расстояние_до_них)
```

**Скрипт формирования:**
- Данные предоставлены организаторами в готовом виде (таблица БД)
- Экспорт: `scripts/export_ndi_data.py` → `market_access_municipality.csv`

**Итоговый файл:**
- **Репозиторий:** `data/components/market_access_municipality.csv`
- **Размер:** 2,571 МО × 3 колонки (`territory_id`, `year`, `market_access`)
- **Использование в NDI:** Нормализация 0-1, вес 0.20

---

#### 3. Consumption (Покупательная способность) — 15% веса в NDI

**Первичные данные:**
- **Таблица БД:** `sberindex.consumption_municipality` (PostgreSQL)
- **Источник:** Сбербанк — агрегированные данные транзакций по картам
- **Период:** июль–декабрь 2024

**Скрипт формирования:**
- Данные предоставлены организаторами (таблица БД)
- Экспорт: `scripts/export_ndi_data.py` → `consumption_municipality_2024.csv`

**Метрика в NDI:**
- Welfare ratio = `потребление / прожиточный_минимум_региона`
- Clipping: максимум 2.0 (норма)
- Нормализация: 0-1 (0.5 = прожиточный минимум, 1.0 = 2× минимум)

**Итоговый файл:**
- **Репозиторий:** `data/components/consumption_municipality_2024.csv`
- **Размер:** 12,578 строк × 4 колонки (`territory_id`, `date`, `category`, `consumption`)
- **Использование в NDI:** Welfare ratio, нормализация 0-1, вес 0.15

---

#### 4. Accessibility (Транспортная доступность) — 15% веса в NDI

**Первичные данные:**
- **Источник:** Координаты 128 НП (latitude, longitude)
- **Метод:** Haversine formula — расстояние до ближайшего хаба

**Скрипты формирования:**
1. `scripts/06_distances.py` — матрица расстояний 128×128
2. `scripts/07_accessibility.py` — расчёт accessibility score

**Формула:**
```
Accessibility = 1 / (1 + distance_to_hub / 500)
```

**Итоговый файл:**
- **Репозиторий:** `data/components/accessibility_scores.csv`
- **Размер:** 128 НП × 4 колонки (`settlement_id`, `settlement_name`, `accessibility_score`, `min_distance_km`)
- **Использование в NDI:** Нормализация 0-1, вес 0.15

---

#### 5. Climate (Климат — нагрузка HDD) — 10% веса в NDI

**Первичные данные:**
- **Источник:** Open-Meteo Historical Weather API (бесплатный)
- **URL:** `https://archive-api.open-meteo.com/v1/archive`
- **Период:** 2023–2024

**Скрипты формирования:**
1. `scripts/09_fetch_climate_data.py` — загрузка температур через API
2. `scripts/10_load_climate_to_postgres.py` — расчёт HDD, загрузка в БД

**Метрика HDD (Heating Degree Days):**
```
HDD_daily = max(0, 18°C - T_mean_daily)
```
Базовая температура 18°C — стандарт СНиП

**Итоговые файлы:**
- `climate_monthly_2023_2024.csv` — 3,072 строки (месячные температуры)
- `climate_yearly_hdd.csv` — 256 строк (годовые HDD)

**Использование в NDI:** Инвертированный HDD (холод = низкий балл), вес 0.10

---

#### 6. Mobility (Мобильность населения) — 5% веса в NDI

**Первичные данные:**
- **Файл:** `arctic/data/mobility_index.xlsx`
- **Источник:** Внешние макроэкономические данные по мобильности населения
- **Период:** 2024 год

**Скрипт формирования:**
- `arctic/etl_load_mobility_index.py` — загрузка из Excel в PostgreSQL

**Метрика:**
- Индекс мобильности в км — среднее расстояние перемещения населения
- Высокая мобильность = экономическая активность

**⚠️ Важно:** При отсутствии данных для конкретного НП используется **fallback значение 0.5** (нейтральное). Для большинства арктических НП данные не совпадают с муниципальными округами, поэтому реальное покрытие ниже 100%.

**Итоговый файл:**
- **Репозиторий:** `data/components/mobility_index_municipality.csv`
- **Размер:** 297 строк × 3 колонки
- **Использование в NDI:** Нормализация 0-1, вес 0.05

---

### Диаграмма Pipeline обработки данных NDI

```
ПЕРВИЧНЫЕ ДАННЫЕ                     ОБРАБОТКА                           ИТОГОВЫЕ CSV
================================================================================

Data_SberIndex_POAD.xlsx   →  01_load_data.py          →  poad_attractiveness_v1.csv
(187 KB, 128 НП × 93)         02_correlation_analysis.py   (128×4, вес 35%)
                              03_attractiveness_v1.py

sberindex.market_access    →  (готовая таблица БД)    →  market_access_municipality.csv
(PostgreSQL, 2571 МО)                                     (2571×3, вес 20%)

sberindex.consumption      →  (готовая таблица БД)    →  consumption_municipality_2024.csv
(PostgreSQL, time-series)                                 (12578×4, вес 15%)

НП координаты              →  06_distances.py          →  accessibility_scores.csv
(latitude, longitude)         07_accessibility.py         (128×4, вес 15%)

Open-Meteo API             →  09_fetch_climate_data.py →  climate_monthly_2023_2024.csv
(2023-2024 температура)       10_load_climate_to_db.py    climate_yearly_hdd.csv
                                                          (вес 10%)

mobility_index.xlsx        →  etl_load_mobility_index.py → mobility_index_municipality.csv
(МО, мобильность км)                                        (297×3, вес 5%)

                                     ↓
                         create_ndi_view.sql
                      (PostgreSQL VIEW: формула NDI)
                                     ↓
                            ndi_scores.csv
                          (128 НП, финальный NDI)
```

---

### Таблица воспроизводимости данных

| Компонент | Первичные данные | Скрипты формирования | Итоговый файл | Покрытие |
|-----------|-----------------|-------------------|---------------|----------|
| **POAD (35%)** | `Data_SberIndex_POAD.xlsx` | `01_load_data.py`<br>`02_correlation_analysis.py`<br>`03_attractiveness_v1.py` | `poad_attractiveness_v1.csv` | 128/128 (100%) |
| **Market Access (20%)** | PostgreSQL: `market_access_municipality` | (готовая таблица БД) | `market_access_municipality.csv` | 128/128 (100%) |
| **Consumption (15%)** | PostgreSQL: `consumption_municipality` | (готовая таблица БД) | `consumption_municipality_2024.csv` | 128/128 (100%) |
| **Accessibility (15%)** | Координаты НП | `06_distances.py`<br>`07_accessibility.py` | `accessibility_scores.csv` | 128/128 (100%) |
| **Climate (10%)** | Open-Meteo API | `09_fetch_climate_data.py`<br>`10_load_climate_to_db.py` | `climate_monthly_2023_2024.csv`<br>`climate_yearly_hdd.csv` | 128/128 (100%) |
| **Mobility (5%)** | `mobility_index.xlsx` | `etl_load_mobility_index.py` | `mobility_index_municipality.csv` | 128/128 (100%) |

**Примечание:** Все компоненты имеют полное покрытие 128 НП благодаря fallback стратегии (региональные средние для пропусков).